function f = circuit_AS(t,z,param)

k1 = param{1};
k2 = param{2};
B = param{3};
B0 = param{4};

r = z(1,:).^2+z(2,:).^2;
A = 1-3/32.*(r+4.*z(3,:).^2);

f(1,:) = 0.5.*(-k1.*z(1,:)-A.*z(2,:));
f(2,:) = 0.5.*(A.*z(1,:)-k1.*z(2,:)+B);
f(3,:) = B0-1/16.*k2.*(3.*r+2.*z(3,:).^2).*z(3,:);

end
